I"ƒH<p>It‚Äôs a write-up about the room : <a href="https://tryhackme.com/room/linuxctf">Try Hack Me - Room : Linux Challenges</a></p>

<h1 id="task-1---linux-challenges-introduction">Task 1 - Linux Challenges Introduction</h1>

<p>We log to the machine with the following credentials :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td> --><td class="rouge-code"><pre>Username: garry  
Password: letmein
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>How many visible files can you see in garrys home directory?</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">ssh -l garry IP_MACHINE</code> and we write the password <strong>letmein</strong>. 
To see how many files there are in home directory we used the command <code class="language-plaintext highlighter-rouge">ls</code>. There are <strong>3</strong> files.</p>

<h1 id="task-2---the-basics">Task 2 - The Basics</h1>

<ul>
  <li>What is flag 1 ?</li>
</ul>

<p>To see the file <strong>flag1</strong> we use the command : <code class="language-plaintext highlighter-rouge">cat flag1.txt</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td> --><td class="rouge-code"><pre>There are flags hidden around the file system, its your job to find them.

Flag 1: f40dc0cff080ad38a6ba9a1c2c038b2c

Log into bobs account to get flag 2.

Username: bob
Password: linuxrules
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The flag 1 is <strong>f40dc0cff080ad38a6ba9a1c2c038b2c</strong>.</p>

<ul>
  <li>What is flag 2 ?</li>
</ul>

<p>We log into bob account with <code class="language-plaintext highlighter-rouge">su bob</code> and the password <em>linuxrules</em>.<br />
On the home directory bob, there is the file <em>flag2.txt</em>. On that one, there is the flag : <strong>8e255dfa51c9cce67420d2386cede596</strong>.</p>

<ul>
  <li>Flag 3 is located where bob‚Äôs bash history gets stored.</li>
</ul>

<p>We use <code class="language-plaintext highlighter-rouge">history</code> on the terminal to see the history commands of Bob.<br />
The flag 3 is <strong>9daf3281745c2d75fc6e992ccfdedfcd</strong>.</p>

<ul>
  <li>Flag 4 is located where cron jobs are created.</li>
</ul>

<p>To list all scheduled cron jobs for the current user :<code class="language-plaintext highlighter-rouge">crontab -l</code>.<br />
The last line is <code class="language-plaintext highlighter-rouge">0 6 * * * echo 'flag4:dcd5d1dcfac0578c99b7e7a6437827f3' &gt; /home/bob/flag4.txt</code>.<br />
So, the flag 4 is : <strong>dcd5d1dcfac0578c99b7e7a6437827f3</strong>.</p>

<ul>
  <li>Find and retrieve flag 5.</li>
</ul>

<p>We search the <strong>flag5</strong> with <code class="language-plaintext highlighter-rouge">locate flag5</code>, we obtain the path : <code class="language-plaintext highlighter-rouge">/lib/terminfo/E/flag5.txt</code>.<br />
After that, to see the content of this file <code class="language-plaintext highlighter-rouge">cat /lib/terminfo/E/flag5.txt</code>.<br />
We find the flag 5 : <strong>bd8f33216075e5ba07c9ed41261d1703</strong>.</p>

<ul>
  <li>‚ÄúGrep‚Äù through flag 6 and find the flag. The first 2 characters of the flag is c9.</li>
</ul>

<p>We locate the flag6. The path is <code class="language-plaintext highlighter-rouge">/home/flag6.txt</code> and we search the flag with the command : <code class="language-plaintext highlighter-rouge">cat home/flag6.txt | grap "c9"</code>.<br />
The flag6 is <strong>c9e142a1e25b24a837b98db589b08be5</strong>.</p>

<ul>
  <li>Look at the systems processes. What is flag 7.</li>
</ul>

<p>To loof the system processes the command is <code class="language-plaintext highlighter-rouge">ps -aux</code> and we search the flag 7 so, <code class="language-plaintext highlighter-rouge">ps -aux | grep "flag7"</code> and we find <strong>274adb75b337307bd57807c005ee6358</strong>.</p>

<ul>
  <li>De-compress and get flag 8.</li>
</ul>

<p>First we locate the file : <code class="language-plaintext highlighter-rouge">/home/bob/flag8.tar.gz</code>.<br />
To extract files from a gz archive : <code class="language-plaintext highlighter-rouge">gunzip file.gz</code>.<br />
To extract all files from archive tar : <code class="language-plaintext highlighter-rouge">tar -xf file.tar</code>.<br />
We extract the file <strong>flag8.txt</strong> and use the command <code class="language-plaintext highlighter-rouge">cat</code> to see the flag : <strong>75f5edb76fe98dd5fc9f577a3f5de9bc</strong>.</p>

<ul>
  <li>By look in your hosts file, locate and retrieve flag 9.</li>
</ul>

<p>Hosts file is locate in <code class="language-plaintext highlighter-rouge">/etc</code>. We use <code class="language-plaintext highlighter-rouge">cat etc/hosts</code> and see the line : <code class="language-plaintext highlighter-rouge">127.0.0.1	dcf50ad844f9fe06339041ccc0d6e280.com</code>.<br />
The flag 9 is <strong>dcf50ad844f9fe06339041ccc0d6e280</strong>.</p>

<ul>
  <li>Find all other users on the system. What is flag 10.</li>
</ul>

<p>We get a list of all users using the <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file with cat or less.
In the list we find the flag <strong>5e23deecfe3a7292970ee48ff1b6d00c</strong>.</p>

<h1 id="task-3---linux-functionality">Task 3 - Linux Functionality</h1>

<ul>
  <li>Run the command flag11. Locate where your command alias are stored and get flag 11.</li>
</ul>

<p>A Bash alias is a method of supplementing or overriding Bash commands with new ones. They are often defined in $HOME/.bashrc or $HOME/bash_aliases (which must be loaded by $HOME/.bashrc).<br />
So, we see the file <code class="language-plaintext highlighter-rouge">.bashrc</code> and find the line :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td> --><td class="rouge-code"><pre>#custom alias
alias flag11='echo "You need to look where the alias are created..."' #b4ba05d85801f62c4c0d05d3a76432e0
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The flag 10 is <strong>b4ba05d85801f62c4c0d05d3a76432e0</strong>.</p>

<ul>
  <li>Flag12 is located were MOTD‚Äôs are usually found on an Ubuntu OS. What is flag12?</li>
</ul>

<p>The motd is a file on Unix-like systems that contains a ‚Äúmessage of the day‚Äù, used to send a common message to all users in a more efficient manner than sending them all an e-mail message. motd is stored in ‚Äú/etc/update-motd.d/‚Äù.<br />
On this folder we find different files and on the first one : <code class="language-plaintext highlighter-rouge">00_header</code> we find the flag 12 : <strong>01687f0c5e63382f1c9cc783ad44ff7f</strong>.</p>

<ul>
  <li>Find the difference between two script files to find flag 13.</li>
</ul>

<p>To see the difference between two scripts : <code class="language-plaintext highlighter-rouge">diff</code>. So, <code class="language-plaintext highlighter-rouge">diff /home/bob/flag13/script1 /home/bob/flag13/script2</code> and the output is :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td> --><td class="rouge-code"><pre>2437c2437
&lt; Lightoller sees Smith walking stiffly toward him and quickly goes to him. He yells into the Captain's ear, through cupped hands, over the roar of the steam... 
---
&gt; Lightoller sees 3383f3771ba86b1ed9ab7fbf8abab531 Smith walking stiffly toward him and quickly goes to him. He yells into the Captain's ear, through cupped hands, over the roar of the steam... 
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The flag 12 is <strong>3383f3771ba86b1ed9ab7fbf8abab531</strong>.</p>

<ul>
  <li>Where on the file system are logs typically stored? Find flag 14.</li>
</ul>

<p>There are stored in the <code class="language-plaintext highlighter-rouge">/var/log</code> directory. In this directory, there is the file <code class="language-plaintext highlighter-rouge">flagtourteen.txt</code>.<br />
In the last line we discover the flag <strong>71c3a8ad9752666275dadf62a93ef393</strong>.</p>

<ul>
  <li>Can you find information about the system, such as the kernel version etc. Find flag 15.</li>
</ul>

<p>Information about the system is available in the file : <code class="language-plaintext highlighter-rouge">/etc/*release</code>. This one contains the line : <code class="language-plaintext highlighter-rouge">FLAG_15=a914945a4b2b5e934ae06ad6f9c6be45</code>. <br />
The flag 15 is <strong>a914945a4b2b5e934ae06ad6f9c6be45</strong>.</p>

<ul>
  <li>Flag 16 lies within another system mount.</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">/media</code> directory contains subdirectories of removable devices.<br />
We find th folder <strong>cab4b7cae33c87794d82efa1e7f834e6</strong> in <code class="language-plaintext highlighter-rouge">/media/f/l/a/g/1/6/is</code>.</p>

<ul>
  <li>Login to alice‚Äôs account and get flag 17. Her password is TryHackMe123.</li>
</ul>

<p>We swap to alice user : <code class="language-plaintext highlighter-rouge">su alice</code> with the password <code class="language-plaintext highlighter-rouge">TryHackMe123</code>.<br />
The file flag17 is on her dictory home and contains the flag <strong>89d7bce9d0bab49e11e194b54a601362</strong>.</p>

<ul>
  <li>Find the hidden flag 18.</li>
</ul>

<p>We use <code class="language-plaintext highlighter-rouge">locate flag18</code> to find the path of this file. We find : <code class="language-plaintext highlighter-rouge">/home/alice/.flag18</code> and using <code class="language-plaintext highlighter-rouge">cat .flag18</code> to see the flag.
The flag18 is <strong>c6522bb26600d30254549b6574d2cef2</strong>.</p>

<ul>
  <li>Read the 2345th line of the file that contains flag 19.</li>
</ul>

<p>We use the command : <code class="language-plaintext highlighter-rouge">sed '2345q;d' flag19</code> because <code class="language-plaintext highlighter-rouge">sed 'NUMq;d' file</code> where NUM is the number of the line you want to print. <br />
The flag is <strong>490e69bd1bf3fc736cce9ff300653a3b</strong>.</p>

<h1 id="task-4---data-representation-strings-and-permissions">Task 4 - Data Representation, Strings and Permissions</h1>

<ul>
  <li>Find and retrieve flag 20.</li>
</ul>

<p>In the file flag20, we find <code class="language-plaintext highlighter-rouge">MDJiOWFhYjhhMjk5NzBkYjA4ZWM3N2FlNDI1ZjZlNjg=</code>. It seemed like a base64 code, so we decode the flag on this website <a href="https://www.base64decode.org/">base64decode.org</a>.<br />
The flag is <strong>02b9aab8a29970db08ec77ae425f6e68</strong>.</p>

<ul>
  <li>Inspect the flag21.php file. Find the flag.</li>
</ul>

<p>We locate this file in <code class="language-plaintext highlighter-rouge">/home/bob/flag21.php</code>. We use <code class="language-plaintext highlighter-rouge">chmod +x</code> to make it executable, and run it :<br />
<code class="language-plaintext highlighter-rouge">./flag21.php: line 1: syntax error near unexpected token `newline' 
&lt;?='MoreToThisFileThanYouThink';?&gt;'lag21_g00djob]`?&gt;</code></p>

<p>The flag21 is <strong>g00djob</strong>.</p>

<ul>
  <li>Locate and read flag 22. Its represented as hex.</li>
</ul>

<p>We locate this file in <code class="language-plaintext highlighter-rouge">/home/alice/flag22</code> : <code class="language-plaintext highlighter-rouge">39 64 31 61 65 38 64 35 36 39 63 38 33 65 30 33 64 38 61 38 66 36 31 35 36 38 61 30 66 61 37 64</code>. 
We decode it on the website <a href="https://www.convertstring.com/fr/EncodeDecode/HexDecode">ConvertString</a> to obtain the flag : <strong>9d1ae8d569c83e03d8a8f61568a0fa7d</strong>.</p>

<ul>
  <li>Locate, read and reverse flag 23.</li>
</ul>

<p>We locate this file in <code class="language-plaintext highlighter-rouge">/home/alice/flag23</code> : <code class="language-plaintext highlighter-rouge">5ffb258330b8437a090c4f66507925ae</code>.<br />
After reversing it on the website <a href="https://codebeautify.org/reverse-string">Reverse-String</a>, we obtain the flag :
<strong>ea52970566f4c090a7348b033852bff5</strong>.</p>

<ul>
  <li>Analyse the flag 24 compiled C program. Find a command that might reveal human readable strings when looking in the source code.</li>
</ul>

<p>We locate this file in <code class="language-plaintext highlighter-rouge">/home/garry/flag24</code>.<br />
We analyse this file using <code class="language-plaintext highlighter-rouge">strings /home/garry/flag24 | grep "flag"</code>. We find 2 lines :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td> --><td class="rouge-code"><pre>flag24.c
flag_24_is_hidd3nStr1ng
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Therefore, the flag is <strong>hidd3nStr1ng</strong>.</p>

<ul>
  <li>Find flag 26 by searching the all files for a string that begins with 4bceb and is 32 characters long.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
</pre></td> --><td class="rouge-code"><pre>find / -xdev -type f -print0 2&gt;/dev/null | xargs -0 grep -E ^[a-z0‚Äì9]{32} 2&gt;/dev/null
</pre></td></tr></tbody></table></code></pre></div></div>

<p>We find the flag <strong>4bceb76f490b24ed577d704c24d6955d</strong>.</p>

<ul>
  <li>Locate and retrieve flag 27, which is owned by the root user.</li>
</ul>

<p>We locate this file file in : <code class="language-plaintext highlighter-rouge">/home/flag27</code>. We log with alice which is a <code class="language-plaintext highlighter-rouge">sudoer user</code>. After that, we used : <code class="language-plaintext highlighter-rouge">sudo cat /home/flag27</code>.
The flag is <strong>6fc0c805702baebb0ecc01ae9e5a0db5</strong>.</p>

<ul>
  <li>Whats the linux kernel version?</li>
</ul>

<p>To see the linux kernel version, we use : <code class="language-plaintext highlighter-rouge">uname-a</code> and the version is <strong>4.4.0-1075-aws</strong>.</p>

<ul>
  <li>Find the file called flag 29 and do the following operations on it:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td> --><td class="rouge-code"><pre>  Remove all spaces in file.
  Remove all new line spaces.
  Split by comma and get the last element in the split.
cat /home/garry/flag29 | tr -d " \n" 
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<p>We use : <code class="language-plaintext highlighter-rouge">cat /home/garry/flag29 | tr -d " \n"</code> and we find <strong>fastidiisuscipitmeaei</strong>.</p>

<h1 id="task-5---sql-ftp-groups-and-rdp">Task 5 - SQL, FTP, Groups and RDP</h1>

<ul>
  <li>Use curl to find flag 30.</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">curl http://10.10.248.235</code> and the output is : <code class="language-plaintext highlighter-rouge">flag30:fe74bb12fe03c5d8dfc245bdd1eae13f</code>.<br />
So, the flag is <strong>fe74bb12fe03c5d8dfc245bdd1eae13f</strong>.</p>

<ul>
  <li>Flag 31 is a MySQL database name.</li>
</ul>

<p>```MySQL username: root
MySQL password: hello</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td> --><td class="rouge-code"><pre>
We log in mysql with : `mysql -u root -p`.  
We want to know the database name, so `SHOW DATABASES;`. We find : 

</pre></td></tr></tbody></table></code></pre></div></div>
<p>+‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-+
| Database                                  |
+‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-+
| information_schema                        |
| database_2fb1cab13bf5f4d61de3555430c917f4 |
| mysql                                     |
| performance_schema                        |
| sys                                       |
+‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-+</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td> --><td class="rouge-code"><pre>
Th flag is **2fb1cab13bf5f4d61de3555430c917f4**.

* Bonus flag question, get data out of the table from the database you found above!

We use `use database_2fb1cab13bf5f4d61de3555430c917f4` and `show tables`. We can see the tables `flags`. Therefore, we do `select * from flags`.

</pre></td></tr></tbody></table></code></pre></div></div>
<p>+‚Äî-+‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-+
| id | flag                             |
+‚Äî-+‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-+
|  1 | ee5954ee1d4d94d61c2f823d7b9d733c |
+‚Äî-+‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-+</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td> --><td class="rouge-code"><pre>
The bonus flag is : **ee5954ee1d4d94d61c2f823d7b9d733c**.

* Using SCP, FileZilla or another FTP client download flag32.mp3 to reveal flag 32

We use FileZilla with :
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Protocol : SFTP - SSH File Transfer Protocol
H√¥te : ip_machine
Port : 22
```
By listening the flag32.mp3, the flag is <strong>tryhackme137</strong>.</p>

<ul>
  <li>Flag 33 is located where your personal PATH‚Äôs are stored.</li>
</ul>

<p>We try in Alice PATH first, anf after Bob. In Bob personal account, with <code class="language-plaintext highlighter-rouge">cat /home/bob/.profile</code> we find : <code class="language-plaintext highlighter-rouge">#Flag 33: 547b6ceee3c5b997b625de99b044f5cf</code>.<br />
Therefore, the flag is <strong>547b6ceee3c5b997b625de99b044f5cf</strong>.</p>
:ET