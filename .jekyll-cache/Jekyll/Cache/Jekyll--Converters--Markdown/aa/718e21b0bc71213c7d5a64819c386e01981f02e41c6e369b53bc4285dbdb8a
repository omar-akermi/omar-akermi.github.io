I"•%<p>Itâ€™s a write-up about the room : <a href="https://tryhackme.com/room/rpnmap">Try Hack Me - Room : Nmap</a></p>

<h1 id="task-1---deploy">[Task 1] - Deploy</h1>

<blockquote>
  <p>Nmap is an incredibly valuable tool in the world of penetration testing. In this room, we will cover the basics of using Nmap to effectively scan a target, gaining insight for further attacks!</p>
</blockquote>

<p>We deploy the instance.</p>

<h1 id="task-2---nmap-quiz">[Task 2] - Nmap Quiz</h1>

<ul>
  <li>
    <p>First, how do you access the help menu?<br />
We access the help menu of nmap, we used the command : <code class="language-plaintext highlighter-rouge">nmap -h</code>. The answer is <code class="language-plaintext highlighter-rouge">-h</code>.</p>
  </li>
  <li>
    <p>Often referred to as a stealth scan, what is the first switch listed for a â€˜Syn Scanâ€™?<br />
Stealth scan, Syn Scan : <code class="language-plaintext highlighter-rouge">-sS</code></p>
  </li>
  <li>
    <p>Not quite as useful but how about a â€˜UDP Scanâ€™? <code class="language-plaintext highlighter-rouge">-sU</code></p>
  </li>
  <li>
    <p>What about operating system detection? <code class="language-plaintext highlighter-rouge">-O</code></p>
  </li>
  <li>
    <p>How about service version detection? <code class="language-plaintext highlighter-rouge">-sV</code></p>
  </li>
  <li>
    <p>Most people like to see some output to know that their scan is actually doing things, what is the verbosity flag? <code class="language-plaintext highlighter-rouge">-v</code></p>
  </li>
  <li>
    <p>What about â€˜very verboseâ€™? (A personal favorite)? <code class="language-plaintext highlighter-rouge">-vv</code></p>
  </li>
  <li>
    <p>Sometimes saving output in a common document format can be really handy for reporting, how do we save output in xml format? <code class="language-plaintext highlighter-rouge">-oX</code></p>
  </li>
  <li>
    <p>Aggressive scans can be nice when other scans just arenâ€™t getting the output that you want and you really donâ€™t care how â€˜loudâ€™ you are, what is the switch for enabling this? <code class="language-plaintext highlighter-rouge">-A</code></p>
  </li>
  <li>
    <p>How do I set the timing to the max level, sometimes called â€˜Insaneâ€™? <code class="language-plaintext highlighter-rouge">-T5</code></p>
  </li>
  <li>
    <p>What about if I want to scan a specific port? <code class="language-plaintext highlighter-rouge">-p</code></p>
  </li>
  <li>
    <p>How about if I want to scan every port? <code class="language-plaintext highlighter-rouge">-p-</code></p>
  </li>
  <li>
    <p>What if I want to enable using a script from the nmap scripting engine? For this, just include the first part of the switch without the specification of what script to run? <code class="language-plaintext highlighter-rouge">--script</code></p>
  </li>
  <li>
    <p>What if I want to run all scripts out of the vulnerability category? <code class="language-plaintext highlighter-rouge">--script vuln</code></p>
  </li>
  <li>
    <p>What switch should I include if I donâ€™t want to ping the host? <code class="language-plaintext highlighter-rouge">-PN</code></p>
  </li>
</ul>

<h1 id="task-3---nmap-scanning">[Task 3] - Nmap Scanning</h1>

<ul>
  <li>Letâ€™s go ahead and start with the basics and perform a syn scan on the box provided. What will this command be without the host IP address?</li>
</ul>

<p>We used the command : <code class="language-plaintext highlighter-rouge">nmap -sS</code>.</p>

<ul>
  <li>After scanning this, how many ports do we find open under 1000?</li>
</ul>

<p>After scanning, we found <code class="language-plaintext highlighter-rouge">2</code> ports under 1000.</p>

<ul>
  <li>
    <p>What communication protocol is given for these ports following the port number?</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td> --><td class="rouge-code"><pre>  PORT   STATE SERVICE
  22/tcp open  ssh
  80/tcp open  http
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<p>The communication protocol of these ports is <code class="language-plaintext highlighter-rouge">tcp</code>.</p>

<ul>
  <li>
    <p>Perform a service version detection scan, what is the version of the software running on port 22?<br />
We used the command <code class="language-plaintext highlighter-rouge">nmap -sV 10.10.74.15</code>. But we could have used <code class="language-plaintext highlighter-rouge">nmap -sV -p 22 10.10.74.15</code>.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td> --><td class="rouge-code"><pre>  PORT   STATE SERVICE VERSION
  22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.10 (Ubuntu Linux; protocol 2.0).  
  80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu)). 
  Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel 
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<p>The version of the software running on port 22 is <code class="language-plaintext highlighter-rouge">6.6.1p1</code>.</p>

<ul>
  <li>Perform an aggressive scan, what flag isnâ€™t set under the results for port 80?<br />
We used the command <code class="language-plaintext highlighter-rouge">nmap -A 10.10.74.15</code>. But we could have used <code class="language-plaintext highlighter-rouge">nmap -A -p 80 10.10.74.15</code>.
The flag isnâ€™t set under the results for port 80 is <code class="language-plaintext highlighter-rouge">httponly</code>.</li>
</ul>

 	```
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td> --><td class="rouge-code"><pre>PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   1024 b5:2a:01:3c:e3:3b:de:85:14:cc:45:cd:0c:0b:5a:4d (DSA)
|   2048 8f:e5:f4:bb:16:c0:53:9c:0c:c0:67:b6:87:b4:9e:7f (RSA)
|   256 03:73:38:8b:2d:9b:40:e4:2d:8b:73:82:a9:d8:8b:4a (ECDSA)
|_  256 a6:ce:4e:14:3c:49:40:cf:28:89:73:a7:f5:7b:14:db (ED25519)
80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
| http-robots.txt: 1 disallowed entry 
|_/
|_http-server-header: Apache/2.4.7 (Ubuntu)
| http-title: Login :: Damn Vulnerable Web Application (DVWA) v1.10 *Develop...
|_Requested resource was login.php
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>
    <p>Perform a script scan of vulnerabilities associated with this box, what denial of service (DOS) attack is this box susceptible to? Answer with the name for the vulnerability that is given as the section title in the scan output. A vuln scan can take a while to complete. In case you get stuck, the answer for this question has been provided in the hint, however, itâ€™s good to still run this scan and get used to using it as it can be invaluable. <br />
We used the command : <code class="language-plaintext highlighter-rouge">nmap --script vuln  10.10.74.15</code>.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td> --><td class="rouge-code"><pre>  PORT   STATE SERVICE
  22/tcp open  ssh
  |_clamav-exec: ERROR: Script execution failed (use -d to debug)
  80/tcp open  http
  |_clamav-exec: ERROR: Script execution failed (use -d to debug)
  | http-cookie-flags: 
  |   /: 
  |     PHPSESSID: 
  |       httponly flag not set
  |   /login.php: 
  |     PHPSESSID: 
  |_      httponly flag not set
  |_http-csrf: Couldn't find any CSRF vulnerabilities.
  |_http-dombased-xss: Couldn't find any DOM based XSS.
  | http-enum: 
  |   /login.php: Possible admin folder
  |   /robots.txt: Robots file
  |   /config/: Potentially interesting directory w/ listing on 'apache/2.4.7 (ubuntu)'
  |   /docs/: Potentially interesting directory w/ listing on 'apache/2.4.7 (ubuntu)'
  |_  /external/: Potentially interesting directory w/ listing on 'apache/2.4.7 (ubuntu)'
  | http-slowloris-check: 
  |   VULNERABLE:
  |   Slowloris DOS attack
  |     State: LIKELY VULNERABLE
  |     IDs:  CVE:CVE-2007-6750
  |       Slowloris tries to keep many connections to the target web server open and hold
  |       them open as long as possible.  It accomplishes this by opening connections to
  |       the target web server and sending a partial request. By doing so, it starves
  |       the http server's resources causing Denial Of Service.
  |       
  |     Disclosure date: 2009-09-17
  |     References:
  |       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750
  |_      http://ha.ckers.org/slowloris/
  |_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<p>The name of the vulnerability that is given as the section title in the scan output is <code class="language-plaintext highlighter-rouge">http-slowloris-check</code>.</p>
:ET