I"þ
<p>Itâ€™s a write-up about the room : <a href="https://tryhackme.com/room/adventofcyber2">Try Hack Me - Room : AdventOfCyber2</a></p>

<h1 id="day-1--a-christmas-crisis">Day 1 : A Christmas Crisis</h1>

<p>We deploy the machine and go on the website with the IP address.</p>

<h2 id="what-is-the-name-of-the-cookie-used-for-authentication">What is the name of the cookie used for authentication?</h2>

<p>We register on the website with a random login and password. For example :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>login : root
password : root0
</pre></td></tr></tbody></table></code></pre></div></div>

<p>We log in and with <code class="language-plaintext highlighter-rouge">F12</code> we acess to the cookies.<br />
The name of the cookie used for authentification is <strong>auth</strong>.</p>

<h2 id="in-what-format-is-the-value-of-this-cookie-encoded-">In what format is the value of this cookie encoded ?</h2>

<p>The value is : 
<code class="language-plaintext highlighter-rouge">7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a226a756a75227d"</code> 
This cookie is encoded in <strong>hexadecimal</strong>.</p>

<h2 id="having-decoded-the-cookie-what-format-is-the-data-stored-in-">Having decoded the cookie, what format is the data stored in ?</h2>

<p>We use : https://gchq.github.io/CyberChef/ and we put <code class="language-plaintext highlighter-rouge">from hex</code> to decode the cookie.
We found : <code class="language-plaintext highlighter-rouge">{"company":"The Best Festival Company", "username":"root"}</code>
Itâ€™s a Java Script Object, so the data are stored in <strong>json</strong>.</p>

<h2 id="figure-out-how-to-bypass-the-authentication">Figure out how to bypass the authentication.</h2>
<ul>
  <li>What is the value of Santaâ€™s cookie ?</li>
</ul>

<p>We put <code class="language-plaintext highlighter-rouge">{"company":"The Best Festival Company", "username":"santa"}</code> into an hexadecimal encoder and find this value :</p>

<p><code class="language-plaintext highlighter-rouge">7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a2273616e7461227d</code></p>

<h2 id="now-that-you-are-the-santa-user-you-can-re-activate-the-assembly-line-">Now that you are the santa user, you can re-activate the assembly line !</h2>
<p>What is the flag youâ€™re given when the line is fully active ?**</p>

<p>We put this new cookie instead of the previous one, activate all the lines and refresh the page to see the flag : <strong>THM{MjY0Yzg5NTJmY2Q1NzM1NjBmZWFhYmQy}</strong></p>
:ET